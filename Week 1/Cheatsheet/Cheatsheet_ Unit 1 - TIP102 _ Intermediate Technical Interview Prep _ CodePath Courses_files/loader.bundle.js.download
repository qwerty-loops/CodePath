(()=>{var e,t;e=function(e){!function(e){const t=e.botId,o=e.jwt,n=e.inlineDivId,r=e.initialMessage||"",s=e.title||"",a=e.userId,i=e.contextRetrievalCallback,c=!1!==e.showChatList&&"false"!==e.showChatList,d=e.tokenRefreshCallback;if(!t||"undefined"==t||!o||"undefined"==o||!n||"undefined"==n)return void console.error("Error: One or more settings are missing or falsy.");const l=document.getElementById(n);if(l){const e=document.createElement("iframe");e.src=`https://ai-chatbot.codepath.org/index.html?initialMessage=${encodeURIComponent(r)}&botId=${encodeURIComponent(t)}&title=${encodeURIComponent(s)}&showChatList=${c}`,e.style.border="none",e.style.height="100%",e.style.width="100%",e.allow="clipboard-write",e.onload=()=>{const t=new URL(e.src).origin;a&&e.contentWindow.postMessage({type:"SET_USER_ID",userId:a},t),e.contentWindow.postMessage({type:"SET_INITIAL_TOKEN",token:o},t),window.addEventListener("message",(o=>{if(o.origin!==t)return;if(o.source!==e.contentWindow)return;const{type:n,requestId:r}=o.data||{};"GET_CONTEXT"===n?async function(e,t,o){const{requestId:n}=e.data;let r={};if("function"==typeof o)try{r=await o()}catch(e){console.error("Context retrieval failed:",e)}e.source.postMessage({type:"CONTEXT_RESPONSE",requestId:n,payload:r},t)}(o,t,i):"TOKEN_REFRESH_REQUEST"===n&&async function(e,t,o){const{requestId:n}=e.data;try{if("function"!=typeof o)throw new Error("Token refresh callback is required");const r=await o();if(!r)throw new Error("Token refresh callback did not return a token");e.source.postMessage({type:"TOKEN_REFRESH_RESPONSE",requestId:n,success:!0,token:r},t)}catch(o){console.error("Token refresh failed:",o),e.source.postMessage({type:"TOKEN_REFRESH_RESPONSE",requestId:n,success:!1,error:o.message},t)}}(o,t,d)}))},l.appendChild(e)}}(e)},(t=window.CodePathAIChatbot&&window.CodePathAIChatbot.q)&&Array.isArray(t)&&t.forEach((function(t){e.apply(null,t)})),window.CodePathAIChatbot=e})();